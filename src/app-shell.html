<link rel="import" href="routes/page-home.html">
<link rel="import" href="components/validate-input.html">
<link rel="import" href="imports.html">
<dom-module id="app-shell">
  <template>
    <style>
       :host {
        --app-primary-color: #4285f4;
        --app-secondary-color: black;

        display: block;
      }

      app-drawer-layout:not([narrow]) [drawer-toggle] {
        display: none;
      }

      app-toolbar {
        color: #fff;
        background-color: var(--app-primary-color);
      }

      app-toolbar ul {
        width: 100%;
        margin-bottom: 20px;
        padding: 10px 15px;
      }

      app-toolbar li {
        width: 49%;
        float: left;
        position: relative;
        display: block;
        margin-bottom: -1px;
      }

      app-header paper-icon-button {
        --paper-icon-button-ink-color: white;
      }

      paper-input {
        background-color: #6e9feb7d;
        margin-left: 2px;
      }

      app-drawer {
        z-index: 1
      }

      .drawer-list {
        margin: 0 20px;
      }

      .drawer-list a {
        display: block;
        padding: 0 16px;
        text-decoration: none;
        color: var(--app-secondary-color);
        line-height: 40px;
      }

      .drawer-list a.iron-selected {
        color: black;
        font-weight: bold;
      }
    </style>

    <app-location route="{{route}}" url-space-regex="^[[rootPath]]"></app-location>
    <app-route route="{{route}}" pattern="[[rootPath]]:page" data="{{routeData}}" tail="{{subroute}}"></app-route>

    <!-- Drawer content -->
    <app-drawer id="drawer" slot="drawer" swipe-open="[[narrow]]">
      <app-toolbar>Menu</app-toolbar>
      <iron-selector selected="[[page]]" attr-for-selected="name" class="drawer-list" role="navigation">
        <a name="home" href="[[rootPath]]home" on-click="_drToggle">home</a>
        <a name="login" href="[[rootPath]]login" on-click="_drToggle">login</a>
        <a name="youtube" href="[[rootPath]]youtube" on-click="_drToggle">youtube</a>
      </iron-selector>
    </app-drawer>

    <app-toolbar>
      <paper-icon-button icon="menu" on-click="_drToggle"></paper-icon-button>
      <ul>
        <li>         
          <validate-input value="{{routeData.page}}"></validate-input>
        </li>
        <li>
          <paper-input label="Search all" value="{{someData}}"></paper-input>
        </li>
      </ul>
      <paper-icon-button icon="menu" on-click="_drToggle"></paper-icon-button>
    </app-toolbar>

    <iron-pages selected="{{page}}" attr-for-selected="name" fallback-selection="view404" role="main">
      <page-home name="home"></page-home>
      <page-login name="login"></page-login>
      <my-youtube name="youtube" dataq="{{someData}}"></my-youtube>
      <page-view404 name="view404"></page-view404>
    </iron-pages>

  </template>
  <script>
    class AppShell extends Polymer.Element {
      static get is() {
        return 'app-shell';
      }
      static get properties() {
        return {
          page: {
            type: String,
            reflectToAttribute: true,
            observer: '_pageChanged',
            notify: true
          },
          routeData: Object,
          subroute: Object,
          rootPath: String,
          someData: {
            type: String,
            value: "",
            notify: true
          },
        };
      }

      static get observers() {
        return [
          '_routePageChanged(routeData.page)',
        ];
      }

      connectedCallback() {
        super.connectedCallback();
        if (window.performance && performance.mark)
          performance.mark('app-shell.connected');
      }

      _drToggle() {
        this.$.drawer.toggle()
      }

      _routePageChanged(page) {
        if (page === "video" || page === "searchYouTube" || page === "channels") {
          this.page = "youtube"
        } else {
          this.page = page || 'home';
        }
      }

      _pageChanged(page) {
        var resolvedPageUrl = this.resolveUrl('routes/page-' + page + '.html');
        Polymer.importHref(
          resolvedPageUrl,
          null,
          null,
          true);
      }
    }

    window.customElements.define(AppShell.is, AppShell);
  </script>
</dom-module>
<html><head><link rel="import" href="../../../../bower_components/iron-flex-layout/iron-flex-layout.html"><link rel="import" href="../../../../bower_components/polymer/polymer.html"><link rel="import" href="../../../../bower_components/polymer/lib/mixins/gesture-event-listeners.html"><link rel="import" href="../../../../bower_components/paper-styles/color.html"><link rel="import" href="../../../../bower_components/paper-input/paper-input.html"><link rel="import" href="../../../../bower_components/paper-toggle-button/paper-toggle-button.html"><link rel="import" href="../../../../bower_components/app-route/app-route.html"><link rel="import" href="../components/youtube-search.html"><link rel="import" href="./youtube-lite.html"><link rel="import" href="./time-input.html"><link rel="import" href="../styles/shared-styles-nav.html"></head><body><dom-module id="video-viewer"><template><style include="shared-styles-nav">:host{display:none;position:relative;height:calc(100vh - 60px);--primary-color:var(--paper-red-500);--primary-text-color:#fff;--paper-toggle-button-unchecked-bar-color:#888;}paper-input{margin-left:-10%;width:74px;}paper-toggle-button{padding-top:31px;}#controls{color:#fff;@apply --layout-vertical;@apply --layout-center-center;height:30%;}#controls>div{@apply --layout-horizontal;padding-bottom:1em;}#state{margin-left:16px;}#player{height:70%;}.z2{z-index:2;}.search{display:none;}.coverInput{position:absolute;width:100%;height:112px;z-index:1;}</style><app-route route="{{route}}" pattern="/:vid" data="{{data}}" query-params="{{queryParams}}"></app-route><youtube-lite id="player" video-id="{{data.vid}}" state="{{queryParams.state}}" current-time="{{queryParams.time}}" start-time="{{queryParams.time}}"></youtube-lite><div id="controls"><time-input id="fds" class="z2" resize="{{resize}}" query="{{queryParams.time}}" time="[[time]]" real-time="{{realTime}}" on-down="pause" on-up="play"></time-input><div class="coverInput"></div><ul class="nav"><li class="nav-item"><paper-input id="time" type="string" label="Elapsed" on-click="prevent" value="{{transformedTime}}"></paper-input></li><li class="nav-item"><span class="nav-link active"></span></li><li class="nav-item"><paper-input id="time" type="string" label="Duration" value="{{fulTime}}"></paper-input></li><li class="nav-item z2"><paper-toggle-button id="state" active="{{playing}}">[[queryParams.state]]</paper-toggle-button></li></ul><youtube-search class="search" search="{{data.vid}}" api="[[Details]]" hide="true" video-data="{{timeData}}"></youtube-search></div></template><script>class videoViewer extends Polymer.GestureEventListeners(Polymer.Element){static get is(){return'video-viewer'}static get properties(){return{route:{type:Object,notify:!0},timeData:{type:Object,observer:'_toSeconds'},realTime:{type:String,obsever:'setTime'},playing:{type:Boolean},transformedTime:{type:String,notify:!0},queryParams:{type:Object},resize:{type:Boolean,notify:!0},hours:{type:String,value:'0'},minutes:{type:String,value:'0'},seconds:{type:String,value:'0'},time:{type:String,notify:!0},fulTime:{type:String,notify:!0},Details:{type:Object,value:function(){return{method:'videoDetails',api:'videos'}}}}}static get observers(){return['_playingChanged(playing)','_stateChanged(queryParams.state)','_time(queryParams)']}ready(){super.ready(),this.set('transformedTime','00:00:00'),window.onresize=function(){let a='APP-SHELL'===Polymer.dom(document.body.children[1]).node.nodeName?Polymer.dom(document.body.children[1]).node:Polymer.dom(document.body.children[3]).node;'video'===a.routeData.page&&(this.set('resize',!1),this.set('resize',!0))}.bind(this)}_toSeconds(a){if(null!==a&&a!==void 0&&!0===a.hasOwnProperty('items')){let b,c,d,e,f;0<a.items[0].contentDetails.duration.indexOf('H')?(b=a.items[0].contentDetails.duration.split('H'),e=b[0].split('PT')[1],c=b[1].split('M')[0],d=b[1].split('M')[1].split('S').join(),e=parseInt(e),c=parseInt(c),d=parseInt(d),e=10>e?`0${e}`:`${e}`,c=10>c?`0${c}`:`${c}`,d=10>d?`0${d}`:`${d}`,b=e+':'+c+':'+d,f=3600*parseInt(e)+60*parseInt(c)+parseInt(d)):(b=a.items[0].contentDetails.duration.split('M'),c=b[0].split('PT')[1],d=b[1].split('S')[0],c=parseInt(c),d=parseInt(d),c=10>c?`0${c}`:`${c}`,d=10>d?`0${d}`:`${d}`,b=c+':'+d,f=60*parseInt(c)+parseInt(d)),this.set('time',f.toString()),this.set('fulTime',b.toString())}}_time(a){!1===a.hasOwnProperty('state')&&(this.transformedTime=`00:00:00`),'playing'===a.state&&(this.set('seconds',10>a.time%60?`0${a.time%60}`:`${a.time%60}`),this.set('transformedTime',`${this.hours}:${this.minutes}:${this.seconds}`),0===parseInt(a.time)%60&&this.getTime(a))}getTime(a){if(!0===a.hasOwnProperty('time')){var b,c,d=a.time/60,e=d.toString().split('.');3600<=a.time?(d=parseFloat(e[0])/60,0<d%60&&(c=parseFloat(a.time/3600).toString().split('.')[0],b=e[0]%60),0===d%60&&(c=parseInt(this.hours.value)+1,b=e[0]%60)):(b=e[0]%60,c='0'),b=10>b?`0${b}`:`${b}`,this.set('minutes',b),c=10>c?`0${c}`:`${c}`,this.set('hours',c)}}pause(){this.set('queryParams.state','paused')}setTime(a){getTime({time:a})}play(){setTimeout(()=>{this.set('queryParams.state','playing')},200)}_playingChanged(a){this.set('queryParams.state',a?'playing':'paused'),this.getTime(this.queryParams)}_stateChanged(a){this.playing='playing'===a,this.getTime(this.queryParams)}}window.customElements.define(videoViewer.is,videoViewer);</script></dom-module></body></html>